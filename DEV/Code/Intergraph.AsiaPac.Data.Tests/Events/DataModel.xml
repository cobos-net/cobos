<?xml version="1.0" encoding="utf-8" ?>
<DataModel name="EventDataModel" xmlns="http://schemas.intergraph.com/asiapac/cad/datamodel/1.0.0" xmlns:cad="http://schemas.intergraph.com/asiapac/cad/datamodel/1.0.0">

	<!--
	~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
	Main Agency Event object
	~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
	-->

	<Object name="AgencyEvent" dbTable="AEVEN">
		<Property name="AgencyEventId" dbColumn="num_1"/>
		<Property name="CommonEventId" dbColumn="eid"/>
		<Property name="ScheduledDestinationCommonEventId" dbColumn="dest_eid"/>
		<Object name="Address" type="EventAddress"/>
		<Property name="DestinationCommonPlaceName" dbColumn="d_ecompl" dbTable="EVENT"/>
		<Object name="Directory" type="EventDirectory"/>
		<Object name="Location" type="EventLocation"/>
		<Object name="Agency" type="AgencyInformation"/>
		<Object name="Type" type="EventType"/>
		<Property name="StatusCode" dbColumn="event_status"/>
		<Property name="Priority" dbColumn="priority"/>
		<Property name="AlarmLevel" dbColumn="alarm_lev"/>
		<Property name="CommunicationDifficulty" dbTable="EVENT" dbColumn="bes_comm_difficulty"/>
		<Object name="Units">
			<Property name="PrimaryUnit" dbColumn="prim_unit"/>
			<Property name="DispatchAssignedUnit" dbColumn="dispass_unit"/>
			<Property name="NumberOfAssignedUnits" dbColumn="assigned_units"/>
		</Object>
		<Object name="Held">
			<Property name="EventTypeCode" dbColumn="hold_type"/>
			<Property name="UnitId" dbColumn="hold_unt"/>
			<Property name="AgreedResponseTimestamp" dbColumn="hold_dts" stringFormat="CadDts"/>
		</Object>
		<Object name="Timestamps" type="EventTimestamps"/>
		<Object name="Caller" type="EventCaller"/>
		<Object name="ChangeHistory" type="EventChangeHistory"/>
		<Reference ref="EventComment" isCollection="true" name="Comments" key="AgencyEventId" refer="AgencyEventId"/>
		<Reference ref="Disposition" key="AgencyEventId" refer="AgencyEventId"/>
		<Metadata>
			<Filters>
				<Filter>AEVEN.open_and_curent = 'T' and AEVEN.curent in ('T', 'O')</Filter>
				<Filter>EVENT.curent in ('T', 'O')</Filter>
			</Filters>
			<Joins>
				<InnerJoin foreignKey="eid" references="EVENT" referenceKey="eid"/>
			</Joins>
		</Metadata>
	</Object>

	<!--
	~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
	Agency Event Summary
	~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
	-->

	<Object name="AgencyEventSummary" dbTable="AEVEN">
		<Property name="AgencyEventId" dbColumn="num_1"/>
		<Property name="CommonEventId" dbColumn="eid"/>
		<Property name="StatusCode" dbColumn="event_status"/>
		<Object name="Timestamps">
			<Property name="LastStatusChanged" dbColumn="scdts" stringFormat="CadDts"/>
		</Object>
		<Metadata>
			<Filters>
				<Filter>AEVEN.open_and_curent = 'T' and AEVEN.curent in ('T', 'O')</Filter>
			</Filters>
			<Joins/>
		</Metadata>
	</Object>

	<!--
	~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
	Agency type
	~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
	-->

	<Type name="AgencyInformation" dbTable="AEVEN">
		<Property name="AgencyId" dbColumn="ag_id"/>
		<Property name="DispatchGroup" dbColumn="dgroup"/>
		<Property name="Lev2" dbColumn="LEV2"/>
		<Property name="Lev3" dbColumn="LEV3"/>
		<Property name="Lev4" dbColumn="LEV4"/>
		<Property name="Lev5" dbColumn="LEV5"/>
	</Type>
	
	<!--
	~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
	Common Event Address type
	~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
	-->

	<Type name="EventAddress" dbTable="EVENT">
		<XsdProperty name="Text" type="xsd:string" minOccurs="0"/>
		<Property name="CommonPlaceName" dbColumn="ecompl" dbAlias="loc_common_placename"/>
		<Property name="ApartmentNumber" dbColumn="eapt" dbAlias="loc_apartment"/>
		<Property name="StreetNumber" dbColumn="estnum" dbAlias="loc_street_num"/>
		<Property name="DirectionalPrefix" dbColumn="edirpre" dbAlias="loc_direction_prefix"/>
		<Property name="StreetName" dbColumn="efeanme" dbAlias="loc_street"/>
		<Property name="StreetType" dbColumn="efeatyp" dbAlias="loc_street_type"/>
		<Property name="DirectionalSuffix" dbColumn="edirsuf" dbAlias="loc_direction_suffix"/>
		<Property name="Suburb" dbColumn="emun" dbAlias="loc_municipality"/>
		<Property name="Area" dbColumn="earea" dbAlias="loc_area"/>
		<Property name="CrossStreet1" dbColumn="xstreet1" dbAlias="loc_xstreet1"/>
		<Property name="CrossStreet2" dbColumn="xstreet2" dbAlias="loc_xstreet2"/>
		<Property name="Comment" dbColumn="loc_com" dbAlias="loc_comments"/>
		<Property name="Verified" dbColumn="loc_ver" dbAlias="loc_verified" stringFormat="CadBoolean"/>
		<Property name="LocationOfInterestSearchPerformed" dbColumn="loi_search" stringFormat="CadBoolean"/>
	</Type>

	<!--
	~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
	Common Event Directory type
	~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
	-->

	<Type name="EventDirectory" dbTable="EVENT">
		<Property name="Melway" dbColumn="ver_melway"/>
		<Property name="VicRoads" dbColumn="ver_vicroads"/>
	</Type>

	<!--
	~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
	Common Event Location type
	~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
	-->

	<Type name="EventLocation" dbTable="EVENT">
		<Property name="X" dbColumn="x_cord"/>
		<Property name="Y" dbColumn="y_cord"/>
	</Type>

	<!--
	~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
	Event type type
	~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
	-->

	<Type name="EventType" dbTable="AEVEN">
		<Object name="Type">
			<Property name="Code" dbColumn="tycod"/>
			<Property name="Description" dbColumn="typ_eng"/>
		</Object>
		<Object name="SubType">
			<Property name="Code" dbColumn="sub_tycod"/>
			<Property name="Description" dbColumn="sub_eng"/>
		</Object>
	</Type>


	<!-- Top level object for testing purposes 
	<Object name="EventStatusTest" type="EventStatus"/>
	-->
	
	<!--
	~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
	Event timeline type
	~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
	-->

	<Type name="EventTimestamps" dbTable="AEVEN">
		<Property name="Creation" dbColumn="sdts" stringFormat="CadDts"/>
		<Property name="Added" dbColumn="ad_ts" stringFormat="CadDts"/>
		<Property name="PendingDispatch" dbColumn="pend_dts" stringFormat="CadDts"/>
		<Property name="FirstDispatched" dbColumn="ds_ts" stringFormat="CadDts"/>
		<Property name="FirstEnroute" dbColumn="en_ts" stringFormat="CadDts"/>
		<Property name="FirstArrived" dbColumn="ar_ts" stringFormat="CadDts"/>
		<Property name="FirstTransport" dbColumn="tr_ts" stringFormat="CadDts"/>
		<Property name="FirstTransportArrived" dbColumn="ta_ts" stringFormat="CadDts"/>
		<Property name="LastStatusChanged" dbColumn="scdts" stringFormat="CadDts"/>
		<Property name="Closed" dbColumn="xdts" stringFormat="CadDts"/>
	</Type>

	<!--
	~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
	Caller type
	~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
	-->

	<Type name="EventCaller" dbTable="EVENT">
		<Property name="Name" dbColumn="clname"/>
		<Property name="PhoneNumber" dbColumn="clrnum"/>
		<Property name="Address" dbColumn="cstr_add"/>
		<Property name="Source" dbColumn="call_sour"/>
	</Type>
	
	<!--
	~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
	Change History
	~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
	-->

	<Type name="EventChangeHistory" dbTable="AEVEN">
		<Property name="OpenAndCurrent" dbColumn="open_and_curent" stringFormat="CadBoolean"/>
		<Property name="Reopened" dbColumn="reopen" stringFormat="CadBoolean"/>
		<Object name="Created">
			<Property name="EmployeeId" dbColumn="create_pers"/>
			<Property name="Terminal" dbColumn="create_term"/>
		</Object>
		<Object name="Updated">
			<Property name="EmployeeId" dbColumn="upers"/>
			<Property name="Terminal" dbColumn="uterm"/>
		</Object>
		<Object name="Closed">
			<Property name="EmployeeId" dbColumn="xpers"/>
			<Property name="Terminal" dbColumn="xterm"/>
			<Property name="Comment" dbColumn="xcmt"/>
		</Object>
	</Type>

	<!--
	~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
	Event Comments, non-agency specific
	~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
	-->

	<Object name="EventComment" type="EventCommentType">
		<Metadata>
			<Filters>
				<Filter>AEVEN.open_and_curent = 'T' and AEVEN.curent in ('T', 'O')</Filter>
			</Filters>
			<Joins>
				<InnerJoin foreignKey="eid" references="AEVEN" referenceKey="eid"/>
			</Joins>
		</Metadata>
	</Object>

	<Type name="EventCommentType" dbTable="EVCOM">
		<Property name="AgencyEventId" dbColumn="num_1" dbTable="AEVEN" hidden="true"/>
		<Property name="CommonEventId" dbColumn="eid" hidden="true"/>
		<Property name="Text" dbColumn="comm"/>
		<Property name="Scope" dbColumn="comm_scope"/>
		<Property name="SystemMessageNumber" dbColumn="comm_key"/>
		<Property name="LineGroup" dbColumn="lin_grp" hidden="true"/>
		<Property name="LineOrder" dbColumn="lin_ord" hidden="true"/>
		<Object name="Created">
			<Property name="Timestamp" dbColumn="cdts" stringFormat="CadDts"/>
			<Property name="EmployeeId" dbColumn="cpers"/>
			<Property name="Terminal" dbColumn="cterm"/>
		</Object>
	</Type>

	<!--
	~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
	Event Disposition
	~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
	-->

	<Object name="Disposition" type="EventDispositionType">
		<Metadata>
			<Filters>
				<Filter>EV_DISPO.curent = 'T'</Filter>
				<Filter>AEVEN.open_and_curent = 'T' and AEVEN.curent in ('T', 'O')</Filter>
			</Filters>
			<Joins>
				<InnerJoin foreignKey="num_1" references="AEVEN" referenceKey="num_1"/>
			</Joins>
		</Metadata>
	</Object>

	<Type name="EventDispositionType" dbTable="EV_DISPO">
		<Property name="AgencyEventId" dbColumn="num_1"/>
		<Property name="CommonEventId" dbColumn="eid"/>
		<Property name="DispositionCode" dbColumn="dispo"/>
		<Property name="CreateTerminal" dbColumn="cterm"/>
		<Property name="EmployeeUnit" dbColumn="row_num"/>
		<Object name="ResultCodes">
			<Property name="Qualifier1" dbColumn="qual1"/>
			<Property name="Qualifier2" dbColumn="qual2"/>
			<Property name="Qualifier3" dbColumn="qual3"/>
		</Object>
		<Property name="UnitId" dbColumn="unit_id"/>
	</Type>

	<!--
	~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
	Event Agencies
	~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
	-->

	<Object name="Agencies" dbTable="AEVEN">
		<Property name="CommonEventId" dbColumn="eid"/>
		<Property name="AgencyId" dbColumn="ag_id"/>
		<Metadata>
			<Filters/>
			<Joins/>
		</Metadata>
	</Object>


</DataModel>
