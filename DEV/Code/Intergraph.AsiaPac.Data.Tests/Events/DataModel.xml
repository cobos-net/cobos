<?xml version="1.0" encoding="utf-8" ?>
<DataModel name="EventDataModel" xmlns="http://schemas.intergraph.com/asiapac/cad/datamodel" xmlns:cad="http://schemas.intergraph.com/asiapac/cad/datamodel">

	<!--
	~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
	Main Agency Event object
	~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
	-->

	<Object name="AgencyEvent" dbTable="AEVEN">
		<Property name="agencyEventNumber" dbColumn="num_1"/>
		<Property name="commonEventNumber" dbColumn="eid"/>
		<Object name="agency" type="Agency"/>
		<Object name="type" type="EventType"/>
		<Object name="subType" type="EventSubType"/>
		<Object name="address" type="EventAddress"/>
		<Object name="location" type="EventLocation"/>
		<Object name="status" type="EventStatus"/>
		<Object name="timeline" type="EventTimeline"/>
	</Object>

	<!--
	~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
	Agency type
	~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
	-->

	<Type name="Agency" dbTable="AEVEN">
		<Property name="agencyId" dbColumn="ag_id"/>
		<Property name="dispatchGroup" dbColumn="dgroup"/>
	</Type>
	
	<!--
	~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
	Common Event Address type
	~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
	-->

	<Type name="EventAddress" dbTable="EVENT">
		<Property name="commonPlaceName" dbColumn="ecompl" dbAlias="loc_common_placename"/>
		<Property name="apartmentNumber" dbColumn="eapt" dbAlias="loc_apartment"/>
		<Property name="streetNumber" dbColumn="estnum" dbAlias="loc_street_num"/>
		<Property name="directionPrefix" dbColumn="edirpre" dbAlias="loc_direction_prefix"/>
		<Property name="streetName" dbColumn="efeanme" dbAlias="loc_street"/>
		<Property name="streetType" dbColumn="efeatyp" dbAlias="loc_street_type"/>
		<Property name="directionSuffix" dbColumn="edirsuf" dbAlias="loc_direction_suffix"/>
		<Property name="xStreet1" dbColumn="xstreet1" dbAlias="loc_xstreet1"/>
		<Property name="xStreet2" dbColumn="xstreet2" dbAlias="loc_xstreet2"/>
		<Property name="area" dbColumn="earea" dbAlias="loc_area"/>
		<Property name="municipality" dbColumn="emun" dbAlias="loc_municipality"/>
		<Property name="comments" dbColumn="loc_com" dbAlias="loc_comments"/>
		<Property name="mslink" dbColumn="fea_mslink" dbAlias="loc_mslink"/>
		<Property name="verified" dbColumn="loc_ver" dbAlias="loc_verified"/>
	</Type>

	<!--
	~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
	Common Event Location type
	~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
	-->

	<Type name="EventLocation" dbTable="EVENT">
		<Property name="x" dbColumn="x_cord"/>
		<Property name="y" dbColumn="y_cord"/>
	</Type>

	<!--
	~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
	Common Event type type
	~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
	-->

	<Type name="EventType" dbTable="AEVEN">
		<Property name="code" dbColumn="tycod"/>
		<Property name="description" dbColumn="typ_eng"/>
	</Type>

	<!--
	~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
	Common Event sub-type type
	~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
	-->

	<Type name="EventSubType" dbTable="AEVEN">
		<Property name="code" dbColumn="sub_tycod"/>
		<Property name="description" dbColumn="sub_eng"/>
	</Type>

	<!--
	~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
	Event status type
	~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
	-->

	<Type name="EventStatus" dbTable="AEVEN">
		<Property name="statusCode" dbColumn="event_status"/>
		<Property name="alarmLevel" dbColumn="alarm_lev"/>
		<Property name="pendingTimer" dbColumn="pend_dts"/>
		<Object name="units" dbTable="AEVEN">
			<Property name="assignedUnits" dbColumn="assigned_units"/>
			<Property name="dispatchAssignedUnit" dbColumn="dispass_unit"/>
		</Object>
		<Object name="hold" dbTable="AEVEN">
			<Property name="type" dbColumn="hold_type"/>
			<Property name="forUnit" dbColumn="hold_unt"/>
			<Property name="timestamp" dbColumn="hold_dts"/>
		</Object>
	</Type>

	<Object name="EventStatusObj" type="EventStatus"/>
	
	<!--
	~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
	Event timeline type
	~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
	-->

	<Type name="EventTimeline" dbTable="AEVEN">
		<Property name="created" dbColumn="ad_ts"/>
		<Property name="dispatched" dbColumn="ds_ts"/>
		<Property name="enroute" dbColumn="en_ts"/>
		<Property name="arrived" dbColumn="ar_ts"/>
		<Property name="transport" dbColumn="tr_ts"/>
		<Property name="transportArrived" dbColumn="ta_ts"/>
	</Type>

	<!--
	~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
	AEVEN Metadata
	~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
	-->

	<TableMetadata name="AEVEN">
		<Filters>
			<Filter name="default">AEVEN.open_and_curent = 'T' and AEVEN.curent in ('T', 'O')</Filter>
		</Filters>
		<Keys>
			<Key foreignKey="eid" references="EVENT" referenceKey="eid"/>
		</Keys>
	</TableMetadata>

	<!--
	~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
	EVENT Metadata
	~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
	-->

	<TableMetadata name="EVENT">
		<Filters>
			<Filter name="default">EVENT.curent in ('T', 'O')</Filter>
		</Filters>
		<Keys>
			<Key foreignKey="eid" references="AEVEN" referenceKey="eid"/>
		</Keys>
	</TableMetadata>

</DataModel>
