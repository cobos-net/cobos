<?xml version="1.0" encoding="utf-8"?>
<Project xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
  <!-- 
  =============================================================================
  Filename: cobos.build.targets
  Description: Cobos Build Targets definitions.
  =============================================================================
  Created by: N.Davis                        Date: 2010-02-09
  Modified by:                               Date:
  =============================================================================
  Notes: 


  =============================================================================
  -->
  <Import Project="$(MSBuildExtensionsPath)\MSBuildCommunityTasks\MSBuild.Community.Tasks.Targets"/>
  <!--
  =============================================================================
  Build Definitions
  =============================================================================
  -->
  <PropertyGroup>
    <QualitySystem>\QualitySystem\BUILD\MSBUILD\</QualitySystem>
    <SchemaDir>$(ProjectDir)..\..\Cobos.Codegen\Schemas\</SchemaDir>
    <FilterGenerated>$(ProjectDir)Filter\Generated\</FilterGenerated>
  </PropertyGroup>
  <!--
  =============================================================================
  Schemas
  =============================================================================
  -->
  <ItemGroup>
    <SchemaFilter Include="
                  $(SchemaDir)Filter.xsd;
                  $(SchemaDir)Sort.xsd"/>
  </ItemGroup>

  <Target Name="BeforeBuild">
    <MSBuild Projects="$(QualitySystem)cobos.svcutil.targets"
             Targets="RunSvcUtil"
             Properties="SvcInput=%(SchemaFilter.Identity);
                       SvcTarget=dataContractOnly;
					             SvcNamespace=Cobos.Data.Filter;
					             SvcOutputFolder=&quot;$(FilterGenerated)%(SchemaFilter.Filename).cs&quot;" />
    
    <FileUpdate Files="$(FilterGenerated)Sort.cs"
                Regex="public class SortBy"
                ReplacementText="public partial class SortBy" />
  </Target>
</Project>
